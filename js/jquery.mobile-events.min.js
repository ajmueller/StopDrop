(function(e){function p(){var e=s();if(e!==o){o=e;r.trigger("orientationchange")}}function w(t,n,r){var i=r.type;r.type=n;e.event.dispatch.call(t,r);r.type=i}e.attrFn=e.attrFn||{};var t=navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(navigator.userAgent.toLowerCase().indexOf("windows")>-1||navigator.userAgent.toLowerCase().indexOf("macintosh")>-1||navigator.userAgent.toLowerCase().indexOf("linux")>-1);var n={swipe_h_threshold:50,swipe_v_threshold:50,taphold_threshold:750,doubletap_int:500,touch_capable:"ontouchstart"in document.documentElement&&navigator.userAgent.toLowerCase().indexOf("chrome")==-1,orientation_support:"orientation"in window&&"onorientationchange"in window,startevent:"ontouchstart"in document.documentElement&&!t?"touchstart":"mousedown",endevent:"ontouchstart"in document.documentElement&&!t?"touchend":"mouseup",moveevent:"ontouchstart"in document.documentElement&&!t?"touchmove":"mousemove",tapevent:"ontouchstart"in document.documentElement&&!t?"tap":"click",scrollevent:"ontouchstart"in document.documentElement&&!t?"touchmove":"scroll",hold_timer:null,tap_timer:null};e.each("tapstart tapend tap singletap doubletap taphold swipe swipeup swiperight swipedown swipeleft scrollstart scrollend orientationchange".split(" "),function(t,n){e.fn[n]=function(e){return e?this.bind(n,e):this.trigger(n)};e.attrFn[n]=true});e.event.special.tapstart={setup:function(){var t=this,r=e(t);r.bind(n.startevent,function(e){if(e.which&&e.which!==1){return false}else{w(t,"tapstart",e);return true}})}};e.event.special.tapend={setup:function(){var t=this,r=e(t);r.bind(n.endevent,function(e){w(t,"tapend",e);return true})}};e.event.special.taphold={setup:function(){var t=this,r=e(t),i,s,o={x:0,y:0};r.bind(n.startevent,function(e){if(e.which&&e.which!==1){return false}else{r.data("tapheld",false);i=e.target;o.x=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageX:e.pageX;o.y=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageY:e.pageY;n.hold_timer=window.setTimeout(function(){var n=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageX:e.pageX,s=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageY:e.pageY;if(e.target==i&&o.x==n&&o.y==s){r.data("tapheld",true);w(t,"taphold",e)}},n.taphold_threshold);return true}}).bind(n.endevent,function(){r.data("tapheld",false);window.clearTimeout(n.hold_timer)})}};e.event.special.doubletap={setup:function(){var t=this,r=e(t),i,s;r.bind(n.startevent,function(e){if(e.which&&e.which!==1){return false}else{r.data("doubletapped",false);i=e.target;return true}}).bind(n.endevent,function(e){var o=(new Date).getTime();var u=r.data("lastTouch")||o+1;var a=o-u;window.clearTimeout(s);if(a<n.doubletap_int&&a>0&&e.target==i&&a>100){r.data("doubletapped",true);window.clearTimeout(n.tap_timer);w(t,"doubletap",e)}else{r.data("lastTouch",o);s=window.setTimeout(function(e){window.clearTimeout(s)},n.doubletap_int,[e])}r.data("lastTouch",o)})}};e.event.special.singletap={setup:function(){var t=this,r=e(t),i=null,s=null,o={x:0,y:0};r.bind(n.startevent,function(e){if(e.which&&e.which!==1){return false}else{s=(new Date).getTime();i=e.target;o.x=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageX:e.pageX;o.y=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageY:e.pageY;return true}}).bind(n.endevent,function(e){if(e.target==i){end_pos_x=e.originalEvent.changedTouches?e.originalEvent.changedTouches[0].pageX:e.pageX;end_pos_y=e.originalEvent.changedTouches?e.originalEvent.changedTouches[0].pageY:e.pageY;n.tap_timer=window.setTimeout(function(){if(!r.data("doubletapped")&&!r.data("tapheld")&&o.x==end_pos_x&&o.y==end_pos_y){w(t,"singletap",e)}},n.doubletap_int)}})}};e.event.special.tap={setup:function(){var t=this,r=e(t),i=false,s=null,o,u={x:0,y:0};r.bind(n.startevent,function(e){if(e.which&&e.which!==1){return false}else{i=true;u.x=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageX:e.pageX;u.y=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageY:e.pageY;o=(new Date).getTime();s=e.target;return true}}).bind(n.endevent,function(e){var r=e.originalEvent.targetTouches?e.originalEvent.changedTouches[0].pageX:e.pageX,a=e.originalEvent.targetTouches?e.originalEvent.changedTouches[0].pageY:e.pageY;if(s==e.target&&i&&(new Date).getTime()-o<n.taphold_threshold&&u.x==r&&u.y==a){w(t,"tap",e)}})}};e.event.special.swipe={setup:function(){function u(e){s.x=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageX:e.pageX;s.y=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageY:e.pageY;o.x=s.x;o.y=s.y;i=true;var t=new Date;while(new Date-t<100){}}function a(e){e.stopPropagation();o.x=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageX:e.pageX;o.y=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageY:e.pageY;window.clearTimeout(n.hold_timer);var t;var u=r.attr("data-xthreshold"),a=r.attr("data-ythreshold"),f=typeof u!=="undefined"&&u!==false&&parseInt(u)?parseInt(u):n.swipe_h_threshold,l=typeof a!=="undefined"&&a!==false&&parseInt(a)?parseInt(a):n.swipe_v_threshold;if(s.y>o.y&&s.y-o.y>l){t="swipeup"}if(s.x<o.x&&o.x-s.x>f){t="swiperight"}if(s.y<o.y&&o.y-s.y>l){t="swipedown"}if(s.x>o.x&&s.x-o.x>f){t="swipeleft"}if(t!=undefined&&i){s.x=0;s.y=0;o.x=0;o.y=0;i=false;r.trigger("swipe").trigger(t)}}function f(e){i=false}var t=this,r=e(t),i=false,s={x:0,y:0},o={x:0,y:0};r.bind(n.startevent,u);r.bind(n.moveevent,a);r.bind(n.endevent,f)}};e.event.special.scrollstart={setup:function(){function o(e,n){i=n;w(t,i?"scrollstart":"scrollend",e)}var t=this,r=e(t),i,s;r.bind(n.scrollevent,function(e){if(!i){o(e,true)}clearTimeout(s);s=setTimeout(function(){o(e,false)},50)})}};var r=e(window),i,s,o,u,a,f={0:true,180:true};if(n.orientation_support){var l=window.innerWidth||e(window).width(),c=window.innerHeight||e(window).height(),h=50;u=l>c&&l-c>h;a=f[window.orientation];if(u&&a||!u&&!a){f={"-90":true,90:true}}}e.event.special.orientationchange=i={setup:function(){if(n.orientation_support){return false}o=s();r.bind("throttledresize",p);return true},teardown:function(){if(n.orientation_support){return false}r.unbind("throttledresize",p);return true},add:function(e){var t=e.handler;e.handler=function(e){e.orientation=s();return t.apply(this,arguments)}}};e.event.special.orientationchange.orientation=s=function(){var e=true,t=document.documentElement;if(n.orientation_support){e=f[window.orientation]}else{e=t&&t.clientWidth/t.clientHeight<1.1}return e?"portrait":"landscape"};e.event.special.throttledresize={setup:function(){e(this).bind("resize",v)},teardown:function(){e(this).unbind("resize",v)}};var d=250,v=function(){y=(new Date).getTime();b=y-m;if(b>=d){m=y;e(this).trigger("throttledresize")}else{if(g){window.clearTimeout(g)}g=window.setTimeout(p,d-b)}},m=0,g,y,b;e.each({scrollend:"scrollstart",swipeup:"swipe",swiperight:"swipe",swipedown:"swipe",swipeleft:"swipe"},function(t,n){e.event.special[t]={setup:function(){e(this).bind(n,e.noop)}}})})(jQuery)
